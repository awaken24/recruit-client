<div class="container">
    <div class="form-card">
        <h2>Esqueci minha senha</h2>

        <form [formGroup]="form" (ngSubmit)="onSubmit()" *ngIf="!emailSent">
            <div class="field">
                <label for="email">Email cadastrado</label>
                <input id="email" formControlName="email" type="email" placeholder="exemplo@email.com"
                    autocomplete="email" aria-describedby="email-help" />
                <div *ngIf="submitted && form.controls['email'].invalid" class="error-message" id="email-help">
                    Por favor, informe um e-mail válido.
                </div>
            </div>

            <button type="submit" [disabled]="loading" aria-label="Enviar link de redefinição de senha">
                <span *ngIf="loading">
                    <i class="fas fa-circle-notch fa-spin"></i> Enviando...
                </span>
                <span *ngIf="!loading">
                    <i class="fas fa-paper-plane"></i> Enviar link
                </span>
            </button>

            <div class="form-footer">
                <a routerLink="/users/login">Voltar para o login</a>
            </div>
        </form>

        <div *ngIf="emailSent" class="email-sent-container">
            <div class="email-icon">
                <i class="fas fa-envelope"></i>
            </div>
            <h3>Email enviado!</h3>
            <div class="email-sent-message">
                Enviamos um link de redefinição de senha para {{emailEnviado}}.
                Verifique sua caixa de entrada e spam.
            </div>
            <button (click)="enviarNovamente()" [disabled]="loading">
                <span *ngIf="loading">
                    <i class="fas fa-circle-notch fa-spin"></i> Enviando...
                </span>
                <span *ngIf="!loading">
                    <i class="fas fa-redo"></i> Enviar novamente
                </span>
            </button>
            <div class="form-footer">
                <a routerLink="/users/login">Voltar para o login</a>
            </div>
        </div>

        <div *ngIf="errorMessage && !emailSent" class="error-message" role="alert">
            {{ errorMessage }}
        </div>
    </div>
</div>
<app-footer></app-footer>